<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Walkabout Map</title>
<style>
html, body, #map-canvas { height: 100%; margin: 0; padding: 0; }
header h1{
  font-family: Roboto, Arial, sans-serif;
  font-weight: normal;
  position: absolute;
  background-color: rgba(77,77,77,.9);
  font-size: 1em;
  color: #F7931E;
  padding: .75em 1em;
  margin: 0;
  z-index: 1;
}
header h1 a{
  color: #F7931E;
}
.info-window { max-width: 400px; overflow: auto; max-height: 320px; }
.info-window h1 { font-size: 1em; }
.info-window p { line-height: 1.5em; }
</style>
<header>
  <h1>Walkabout Map, via <a href="http://www.walkabout.sg/">walkabout.sg</a></h1>
</header>
<div id="map-canvas"></div>
<script src="https://maps.googleapis.com/maps/api/js?signed_in=true&key=AIzaSyDpk0BS7iLdbn5U545tiIN12k1OCgj2cc4"></script>
<script>
google.maps.event.addDomListener(window, 'load', function(){
  map = new google.maps.Map(document.getElementById('map-canvas'), {
    zoom: 12,
    center: { lat: 1.3520830, lng: 103.8198360 }
  });
  map.data.loadGeoJson('sg-companies.geojson');

  var infoWindow = new google.maps.InfoWindow();
  map.data.setStyle({
    icon: {
      path: google.maps.SymbolPath.CIRCLE,
      fillColor: '#F7931E',
      fillOpacity: 1,
      strokeColor: '#fff',
      strokeWeight: 2,
      scale: 5
    }
  });
  map.data.addListener('click', function(e){
    console.log(e);
    var feature = e.feature;
    var description = feature.getProperty('description');
    var desc = description.length > 140 ? (description.slice(0, 140) + '&hellip;') : description;
    var website = feature.getProperty('website');
    infoWindow.setContent('<div class="info-window">'
      + '<h1>' + feature.getProperty('name') + '</h1>'
      + '<p title="' + description + '">' + desc + '</p>'
      + '<p><a href="' + website + '">' + website + '</a></p>'
    + '</div>');
    infoWindow.setPosition(e.latLng);
    infoWindow.open(map);
  });
});
</script>
